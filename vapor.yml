id: sistema-compraventa
name: Sistema Compraventa
environments:
    production:
        memory: 1024
        cli-memory: 512
        runtime: 'php-8.1:al2'
        build:
            - 'COMPOSER_MIRROR_PATH_REPOS=1 composer install --no-dev'
            - 'php artisan event:cache'
            - 'npm install'
            - 'npm run build'
            - 'rm -rf node_modules'
        deploy:
            - 'php artisan storage:link'
            - 'php artisan migrate:fresh --force'
            - 'php artisan db:seed --class=CountryTableSeeder --force'
            - 'php artisan db:seed --class=StateTableSeeder --force'
            - 'php artisan db:seed --class=MunicipalityTableSeeder --force'
            - 'php artisan db:seed --class=ParishTableSeeder --force'
            - 'php artisan db:seed --class=ProductCategorySeeder --force'
            - 'php artisan db:seed --class=ProductSubcategorySeeder --force'
            - 'php artisan db:seed --class=ProductPresentationSeeder --force'
            - 'php artisan db:seed --class=ProductLineSeeder --force'
            - 'php artisan db:seed --class=BrandSeeder --force'
            - 'php artisan db:seed --class=AdminUserSeeder --force'
            - 'chmod -R 775 storage'
            - 'chmod -R 775 storage/app/public'
            - 'chown -R www-data:www-data storage'
            - 'chown -R www-data:www-data storage/app/public'
        domain: tu-dominio.com
        database: vapor
        cache: vapor
        storage: ${VAPOR_STORAGE_DRIVER}
        queues:
            - default
        warm: 5
        timeout: 30
        build-env:
            - 'ASSET_URL=${ASSET_URL}'
            - 'VITE_APP_URL=${APP_URL}'
        directories:
            - 'storage/app/public'
            - 'storage/framework/cache'
            - 'storage/framework/sessions'
            - 'storage/framework/views'
            - 'storage/logs'
            - 'public/build'
        assets:
            - 'public/build' 